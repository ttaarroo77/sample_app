# データベース設計レビュー議事録
日時：2024年2月13日

## 1. レビュー内容

### 1-1. データベース構造の確認
- Supabase（PostgreSQL）を採用
- 3つの主要テーブル：
  - profiles（ユーザープロフィール）
  - boards（看板）
  - goals（目標）

### 1-2. 主な設計変更点
1. `boards`テーブルに`parent_goal_id`を追加
   - 目標と看板の階層関係を明確化
   - 双方向の参照が可能に

2. セキュリティポリシーの整理
   - プロフィール：全体公開（閲覧のみ）
   - 看板・目標：所有者のみアクセス可能

3. インデックス設計の追加
   - ユーザー名検索
   - 看板・目標の関連検索
   - タイプ・ステータスによる検索

## 2. 技術的な決定事項

### 2-1. マイグレーション管理
- `20240212000000_create_tables.sql`で一括管理
- テーブル作成前に既存オブジェクトを安全に削除

### 2-2. シードデータ
- テスト用アカウント：`test@example.com`
- サンプルデータ：
  - 3つの看板
  - 3つの目標（big/medium/small）

### 2-3. 環境設定
- ローカル開発環境：
  - Supabase URL: `http://localhost:54321`
  - Docker管理スクリプトの整備

## 3. 今後の課題

### 3-1. 拡張検討項目
- AI処理ログテーブル
- Markdownインポート履歴
- タグ機能
- コメント機能

### 3-2. 次のステップ
1. マイグレーションファイルの更新
2. 型定義の更新（`types/supabase.ts`）
3. フロントエンド側の実装調整

## 4. ドキュメント管理

- 概要設計：`docs/overview_0/database.md`
- 詳細設計：`docs/system_design_2/database.md`
- 履歴管理：`docs/history/`配下

以上の設計変更を反映し、開発を進めることとする。 