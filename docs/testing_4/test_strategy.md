---
name: "docs/testing_4/test_strategy.md"
title: "テスト戦略 (Test Strategy)"
description: "AI Todo Management - テスト方針・範囲のまとめ"
---

# テスト戦略 (Test Strategy)

本ドキュメントでは、「**AI Todo Management**」アプリのテスト方針や範囲、実施方法をまとめます。

---

## 1. テスト目的と範囲

- **目的**:  
  1. ユーザーが円滑に大・中・小目標を管理できることを確認する  
  2. AI連携(オプション)やMarkdown入出力(オプション)が正常動作することを検証する  
  3. 認証/認可が正しく機能し、未ログインでの操作が制限されることを保証する  

- **範囲**:  
  - **フロントエンド(Next.js)** のコンポーネント/ページの単体テスト・統合テスト  
  - **バックエンド**(Node.js/ExpressまたはSupabase SSR) のAPIエンドポイントテスト  
  - **E2Eテスト**(CypressやPlaywright) による全体動作確認  
  - **AI API**部分はモック/スタブを使用し、異常時のハンドリングを含め確認

---

## 2. テスト種類

| テスト種類         | 内容                                     | ツール/フレームワーク         |
|-------------------|------------------------------------------|-------------------------------|
| **単体テスト**     | 関数やコンポーネント、モデル単位のテスト   | Jest, React Testing Library   |
| **統合テスト**     | フロントとバックエンドAPI連携のテスト     | Jest/Supertest (API), etc.    |
| **E2Eテスト**      | ブラウザ操作を模擬して、シナリオを一貫検証 | Cypress, Playwright           |
| **UIスナップショット** (任意)| UI変更差分がないかを自動チェック       | Jest + Storybook, etc.        |

---

## 3. テスト環境・CI/CD

1. **ローカル環境**  
   - `npm test` or `yarn test` で単体テスト/統合テストを実行  
   - E2Eテストは `npm run e2e` などで起動し、開発サーバー上でブラウザテスト

2. **CI/CD (GitHub Actions 例)**  
   - プルリク作成時に自動で単体テストが走る  
   - メインブランチへマージ時、E2Eテストを行う (Cypressなど)  
   - 全テストがパスしたらデプロイ

---

## 4. テストデータとモック

- **AI連携テスト**:  
  - OpenAI APIを実際に叩くとコストがかかるため、**モック**を利用しレスポンス例を固定  
  - エラーレスポンス・成功レスポンスをそれぞれ用意してハンドリング確認

- **DB (Supabase/PostgreSQL)**:  
  - テスト専用DB or SQLiteを利用し、テスト完了後にデータをクリア  
  - ORM(Prisma, TypeORM等) を用いる場合はMigrationテストも実施

---

## 5. テスト項目の管理

- 詳細なテスト項目は以下のファイルを参照:
  - [integrationTests.csv](./integrationTests.csv)
  - [systemTests.csv](./systemTests.csv)
  - (必要に応じて) [test_cases.md](./test_cases.md) でシナリオ単位のテストケースをまとめる

---

## 6. テストスケジュール (例)

- **フェーズ1**: 単体テスト (フロント/バック)  
- **フェーズ2**: 統合テスト (APIとフロント連携), AI連携モックテスト  
- **フェーズ3**: E2Eテスト, UIテスト  
- **フェーズ4**: パフォーマンステスト (必要に応じ)

---

## 7. リスク・留意点

- AI連携のテストはモック中心。実際のAPI呼び出し回数制限に注意  
- Supabase SSRやRLS（Row Level Security）を使う場合、ロール・ポリシーのテストが必要  
- フィーチャーフラグ(将来機能)はテスト時にON/OFFパターンを検証

---

## 8. まとめ

本テスト戦略に従い、各種テストを段階的に実施し、リリース前に十分な品質を保証する。  
実装状況や追加機能に応じて、随時テスト戦略を更新していく。
